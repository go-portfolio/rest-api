# REST API Project

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

rest-api/
‚îú‚îÄ cmd/
‚îÇ ‚îú‚îÄ app/ # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ ‚îî‚îÄ utils/ # —É—Ç–∏–ª–∏—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä config_printer.go
‚îú‚îÄ internal/
‚îÇ ‚îî‚îÄ config/ # —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
‚îú‚îÄ migrations/ # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ configs/
‚îÇ ‚îî‚îÄ config.yaml # —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ Makefile
‚îî‚îÄ .env.example # –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è


---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –°–æ–∑–¥–∞—Ç—å `.env`  

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

```bash
cp .env.example .env
–ü—Ä–∏–º–µ—Ä .env:

DB_HOST=localhost
DB_PORT=5432
DB_USER=alex
DB_PASSWORD=secret
DB_NAME=restapi
–í–∞–∂–Ω–æ: .env –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –∏ —Ö—Ä–∞–Ω–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ.

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Go
go mod tidy
3. Makefile ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
–ö–æ–º–∞–Ω–¥–∞	–û–ø–∏—Å–∞–Ω–∏–µ
make run	–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–π
make migrate-up	–ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-down	–û—Ç–∫–∞—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
make migrate-force	–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –º–∏–≥—Ä–∞—Ü–∏–π. –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é: make migrate-force VERSION=2
make migrate-reset	–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π

4. –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-up

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
make migrate-down

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏—é –º–∏–≥—Ä–∞—Ü–∏–π
make migrate-force VERSION=1

# –°–±—Ä–æ—Å–∏—Ç—å –±–∞–∑—É –∏ –∑–∞–Ω–æ–≤–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-reset
5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

Makefile –∏—Å–ø–æ–ª—å–∑—É–µ—Ç .env –∏ config_printer.go, —á—Ç–æ–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å DSN –∏ –ø—É—Ç—å –∫ –º–∏–≥—Ä–∞—Ü–∏—è–º.

–ü—Ä–æ–µ–∫—Ç –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –ª—é–±–æ–π –º–∞—à–∏–Ω–µ, –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—è —Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏.

6. –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
–ú–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ migrations/ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –Ω–æ–º–µ—Ä–∞ –≤–µ—Ä—Å–∏–∏:
001_create_tasks_table.up.sql
001_create_tasks_table.down.sql
Go-–∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç internal/config –∏ config_printer.go –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è DSN –∏ –ø—É—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–π.

# –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã TasksHandler —Å —Å–µ—Ä–≤–∏—Å–æ–º –∏ –º–æ–∫–∞–º–∏
+--------+          +----------------+          +----------------------+
| Client |  GET/POST | HTTP Handler  | TaskService |  –†–µ–∞–ª—å–Ω–∞—è –ë–î / Mock  |
+--------+  ------>  +----------------+ ------>  +----------------------+
              /tasks          |                        |
                             v                        v
                      TasksHandler(svc)        svc.GetTasks() / svc.CreateTask()
                             |                        |
                             |                        |
                    JSON Encode/Decode           –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ñ–∏–∫—Ç–∏–≤–Ω—ã—Ö ID
                             |
                             v
                       Response (JSON)
                             |
                             v
                          Client

üîπ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —à–∞–≥–æ–≤

## Client

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å (GET /tasks –∏–ª–∏ POST /tasks).

HTTP Handler (TasksHandler)

–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å TaskService (svc).

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–µ—Ç–æ–¥–∞ (GET –∏–ª–∏ POST) –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ —Å–µ—Ä–≤–∏—Å–∞.

–ö–æ–¥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –∫–ª–∏–µ–Ω—Ç—É.

## TaskService

–ú–æ–∂–µ—Ç –±—ã—Ç—å:

–†–µ–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (PostgresTaskService) ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

Mock (MockTaskService) ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤.

## –†–µ–∞–ª—å–Ω–∞—è –ë–î / Mock

–í —Å–ª—É—á–∞–µ —Ä–µ–∞–ª—å–Ω–æ–π –ë–î –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è SQL-–∑–∞–ø—Ä–æ—Å—ã (SELECT –∏–ª–∏ INSERT).

–í —Å–ª—É—á–∞–µ –º–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ID.

## Response

Handler –∫–æ–¥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É.

–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –±–µ–∑ –∑–Ω–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –º–æ–∫ –∏–ª–∏ —Ä–µ–∞–ª—å–Ω–∞—è –±–∞–∑–∞.

## –†–∞–±–æ—Ç–∞ —Å API

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ `/login`

–û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST-–∑–∞–ø—Ä–æ—Å —Å –ª–æ–≥–∏–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```bash
curl -X POST http://localhost:8080/login \
  -H "Content-Type: application/json" \
  -d '{"username":"alex","password":"password123"}'
```  
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```bash
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU4NTAzNDMsInVzZXJfaWQiOjF9.Oi05RSu-G1_y9CbfIQ7NYFkmpJYxoX7cCA-kYrQGEGw"
}
```
token ‚Äî —ç—Ç–æ –≤–∞—à JWT, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ /tasks
–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏, –ø–µ—Ä–µ–¥–∞–≤ —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization:
```bash
curl http://localhost:8080/tasks \
  -H "Authorization: Bearer <–≤–∞—à_JWT_—Ç–æ–∫–µ–Ω>"
```  
–ü—Ä–∏–º–µ—Ä —Å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º:
```bash
curl http://localhost:8080/tasks \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTU4NTAzNDMsInVzZXJfaWQiOjF9.Oi05RSu-G1_y9CbfIQ7NYFkmpJYxoX7cCA-kYrQGEGw"
```  
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
[
  {"id":1,"title":"Test task","status":"todo"},
  {"id":2,"title":"Test task","status":"todo"}
]
```
